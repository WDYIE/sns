<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<title>Person Page</title>
<link href="dist/css/bootstrap.css" rel="stylesheet" type="text/css">
<link href="dist/css/style.css" rel="stylesheet" type="text/css">
<script src="dist/js/jquery-1.11.1.min.js"></script>
<script src="dist/js/bootstrap.min.js"></script>

</head>
<body style="background: #E9EDF0">

	<div class="navbar navbar-inverse navbar-fixed-top" role="navigation"
		style="background-color:#227DC5;">
		<div class="container">
			<div class="row">
				<div class="col-md-3">
					<img src="images/logo.png">
				</div>
				<div class="col-md-6">
					<div class="collapse navbar-collapse">
						<ul class="nav navbar-nav top-nav">
							<li><a href="index.html">Index</a></li>
							<li><a href="person.html">Personal Page</a></li>
							<li><a href="public.html">Public Page</a></li>
							<li><a href="friend.html">Friend</a></li>
						</ul>
					</div>
				</div>
				<div class="col-md-3">
					<form>
						<input type=text id="search" placeholder="search"
							class="form-control" style="margin-bottom:5px;margin-top:10px">
					</form>
				</div>
			</div>
		</div>
	</div>


	<div class="container" style="margin-top:80px;">
		<div class="row">
			<div class="col-md-3">
				<div class="col-md-12">
					<img class="col-md-8" src="" id="face-image"
						style="min-height: 125px;min-width: 155px;" />

					<div class="col-md-4" style="padding-top:20%">
						<h3 class="text-info" id="face-name"></h3>
					</div>
				</div>
				<div class="col-md-12 row">
					<input type="button" id="change" class="btn btn-lg btn-default"
						value="modify the information" style="margin-top:10px;"><br />
					<aside id="person"></aside>
				</div>
			</div>

			<div class="col-md-6">

				<div class="bs-example bs-example-tabs" style="margin-top:20px;">
					<ul id="myTab" class="nav nav-tabs">
						<li class="active"><a href="#my-news" title="my-news"
							data-toggle="tab">my fresh news</a></li>
						<li class><a href="#messages-to-me" title="messages-to-me"
							data-toggle="tab">messages to me</a></li>
						<li class><a href="#my-photos" title="my-photos"
							data-toggle="tab">my photos</a></li>
					</ul>
					<div id="myTabcontent" class="tab-content">
						<div class="tab-pane active" id="my-news"></div>
						<div class="tab-pane" id="messages-to-me"></div>
						<div class="tab-pane" id="my-photos">

							<div class="row">
								<div class="col-md-4">
									<a href="#" class="thumbnail"> <img
										data-src="holder.js/100%x180" alt="photo"
										style="height:180px;width:100%;display:block;">
									</a>
								</div>
								<div class="col-md-4">
									<a href="#" class="thumbnail"> <img
										data-src="holder.js/100%x180" alt="photo"
										style="height:180px;width:100%;display:block;">
									</a>
								</div>
								<div class="col-md-4">
									<a href="#" class="thumbnail"> <img
										data-src="holder.js/100%x180" alt="photo"
										style="height:180px;width:100%;display:block;">
									</a>
								</div>
								<div class="col-md-4">
									<a href="#" class="thumbnail"> <img
										data-src="holder.js/100%x180" alt="photo"
										style="height:180px;width:100%;display:block;">
									</a>
								</div>
								<div class="col-md-4">
									<a href="#" class="thumbnail"> <img
										data-src="holder.js/100%x180" alt="photo"
										style="height:180px;width:100%;display:block;">
									</a>
								</div>
								<div class="col-md-4">
									<a href="#" class="thumbnail"> <img
										data-src="holder.js/100%x180" alt="photo"
										style="height:180px;width:100%;display:block;">
									</a>
								</div>
							</div>

						</div>
					</div>
				</div>
			</div>

			<div class="col-md-3">

				<div class="panel-group" id="accordion">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h4 class="panel-title">
								<a data-toggle="collapse" data-toggle="collapse"
									data-parent="#accordion" href="#collapseOne"> All friends </a>
							</h4>
						</div>
						<div id="collapseOne" class="panel-collapse collapse ">
							<div class="panel-body">
								<ul id="friends" class="list-unstyled">

								</ul>
							</div>
						</div>
					</div>
					<div class="panel panel-default">
						<div class="panel-heading">
							<h4 class="panel-title">
								<a data-toggle="collapse" data-toggle="collapse"
									data-parent="#accordion" href="#collapseTwo"> Online
									friends </a>
							</h4>
						</div>
						<div id="collapseTwo" class="panel-collapse collapse ">
							<div class="panel-body">
								<ul>
									<li>Tom</li>
									<li>Jack</li>
									<li>Sherly</li>
								</ul>
							</div>
						</div>
					</div>
				</div>

			</div>

		</div>
	</div>

	<script>
		var pName;
    var get = {
        person: function () {
            console.log('get person');
            $.ajax({
                url: "json/getInfo",
                type: "get",
                dataType: "json",
                success: function (data, status) {
                    var data=  data.result[0];
                    pName=data['username'];
                    $('#person').html('');
                    $('<h4 style="margin-top:30px;">ID:' + '<span id="p-id" contenteditable="true">'
                            + data['userId'] + '</span></h4><h4>name:' + '<span id="p-name" contenteditable="true">'
                            + data['username'] + '</span></h4><h4>Phone:' + '<span id="p-phone">'
                            + data["phone"] + '</span></h4><h4>E-mail:' + '<span id="p-email">'
                            + data["email"] + '</span></h4><h4>QQ:' + '<span id="p-qq" contenteditable="true">'
                            + data["qq"] + '</span></h4>').appendTo('#person');
                    $('#face-image').prop({"src": "getImage?id="+data.userId});
                    $('#face-name').text(data.name);
                }
            });
        },
        friends: function () {
            console.log('get friends');
            $.ajax({
                url: "json/getFriend",
                type: "get",
                dataType: "json",
                success: function (data, status) {
                    $.each(
                            data.result,
                            function (i, item) {
                                $('<li><a target="_blank" href="public.html?id='+item["userId"]+'">' + item["username"] + '</a></li>').appendTo('#friends');
                            });

                }
            });
        },
        things: function () {
            console.log('get things');
            $.ajax({
                url: "json/getThing?type=0",
                type: "get",
                dataType: "json",
                success: function (data, status) {
                 $('#my-news').html(' ');
                    $.each(
                            data.result,
                            function (i, item) {
                                $('<article style="background: #fff;border-radius: 3px; "><h3><a style="cursor: pointer">' +pName + '</a>:'
                                        + item["content"] + '</h3><img src="getThingImage?id='
                                        + item["thingId"] + '"style="max-width:550px;"><span>'
                                        + item["time"] + '</span><span class="col-lg-offset-8">comments:'
                                        + item["commentNum"] + '</span></article>').appendTo('#my-news');
                            });

                }
            });
        },
        messages: function () {
            console.log('get messages');
            $.ajax({
                url: "json/getMessages",
                type: "get",
                dataType: "json",
                success: function (data, status) {
					$('#messages-to-me').html(' ');
                    $.each(
                            data.result,
                            function (i, item) {
                                $('<article><h3><a style="cursor: pointer">' + item["sender"] + '</a>:'
                                        + item["content"] + '</h3><span>'
                                        + item["time"] + '</span></article>').appendTo('#messages-to-me');
                            });

                }
            });
        },
        photos: function () {
            console.log("get photots");
        }
    };
    var post={
    	person:function(){
    	console.log( + "---" + "---" + "---" + $('#p-qq').text());
    	$.post("modifyInfo",
				       {username:$('#p-name').text(),qq: $('#p-qq').text()},
				       function(data){
				          alert("Modify Success!!!");
				           get.person();
				       } 
				);
    	}
    }
    $('#myTab a').click(function (e) {
        switch (e.target.title) {
            case 'my-news':
                get.things();
                break;
            case 'messages-to-me':
                get.messages();
                break;
            case 'my-photos':
                get.photos();
                break;
        }
        e.preventDefault();

        $(this).tab('show')
    });
    $(function () {
        get.person();
        get.friends();
        get.things();
        $('#change').click(function () {
            console.log($('#p-name').text() + "---" + "---" + "---" + $('#p-qq').text());
            post.person();
        });
        $('#leave').click(function () {
           console.log('leave click');
        });
    });
    $('#search').keydown(function(event){
        var key_code = event.keyCode;
        if (key_code==13)
        {
            location.replace("search.html?name="+$('#search').val());
            return false;
        }

    });
	</script>
</body>


<footer>
	<p style="text-align:center;">
		Copyright@Six Degree|<a href="about.html" target="_blank"
			class="navbar-link">About us</a></br>Authorized by Class 9 of Software
		Engineering B7
	</p>
</footer>


</html>